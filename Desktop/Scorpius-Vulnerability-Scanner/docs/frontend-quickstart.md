# Frontend Integration Quick Start Guide

## Overview
This guide provides everything a frontend developer needs to integrate with the Scorpius Enterprise API and build a modern React/Vite dashboard.

## Backend API Ready âœ…

The Scorpius backend has been enhanced with enterprise-grade features:

- **FastAPI Server**: Running on http://localhost:8080
- **REST API**: Complete CRUD operations for scans, simulations, plugins
- **WebSocket API**: Real-time updates and notifications
- **Authentication**: JWT-based with user management
- **CORS Enabled**: Configured for frontend development

## Quick Setup

### 1. Start the Backend API

```bash
# Option 1: Quick start (Windows)
.\setup-enterprise.ps1

# Option 2: Quick start (Linux/macOS)  
./setup-enterprise.sh

# Option 3: Manual start
python start_server.py
```

### 2. Verify API is Running

```bash
# Test API endpoints
python test_api.py

# Or check manually
curl http://localhost:8080/health
```

### 3. Access API Documentation

- **Swagger UI**: http://localhost:8080/docs
- **ReDoc**: http://localhost:8080/redoc
- **Full Documentation**: `docs/api-documentation.md`

## Frontend Development

### Recommended Stack

```json
{
  "framework": "React 18+",
  "bundler": "Vite",
  "ui": "Tailwind CSS + Headless UI",
  "charts": "Recharts or Chart.js",
  "websockets": "socket.io-client or native WebSocket",
  "http": "Axios or Fetch API",
  "state": "Zustand or Redux Toolkit",
  "routing": "React Router v6"
}
```

### Create React App

```bash
# Create new Vite React app
npm create vite@latest scorpius-dashboard -- --template react-ts
cd scorpius-dashboard
npm install

# Install recommended dependencies
npm install axios recharts @headlessui/react @heroicons/react
npm install -D tailwindcss postcss autoprefixer
npx tailwindcss init -p
```

### Environment Setup

Create `.env.local`:
```env
VITE_API_BASE_URL=http://localhost:8080
VITE_WS_BASE_URL=ws://localhost:8080
VITE_APP_NAME=Scorpius Dashboard
```

## API Integration Examples

### Authentication

```typescript
// auth.ts
const API_BASE = import.meta.env.VITE_API_BASE_URL;

export interface AuthResponse {
  access_token: string;
  token_type: string;
  expires_in: number;
  user_id: string;
}

export async function login(username: string, password: string): Promise<AuthResponse> {
  const response = await fetch(`${API_BASE}/api/v1/auth/login`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ username, password })
  });
  
  if (!response.ok) throw new Error('Login failed');
  return response.json();
}

export function getAuthHeader(token: string) {
  return { Authorization: `Bearer ${token}` };
}
```

### Scan Management

```typescript
// scans.ts
export interface ScanRequest {
  target_type: 'file' | 'source_code' | 'contract_address';
  target_identifier: string;
  scan_type: 'static' | 'dynamic' | 'full' | 'quick';
  plugins?: string[];
  priority?: 'low' | 'normal' | 'high';
}

export async function startScan(request: ScanRequest, token: string) {
  const response = await fetch(`${API_BASE}/api/v1/scan`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      ...getAuthHeader(token)
    },
    body: JSON.stringify(request)
  });
  
  return response.json();
}

export async function getScanStatus(scanId: string, token: string) {
  const response = await fetch(`${API_BASE}/api/v1/scan/${scanId}/status`, {
    headers: getAuthHeader(token)
  });
  
  return response.json();
}
```

### WebSocket Integration

```typescript
// websocket.ts
export class ScorpiusWebSocket {
  private ws: WebSocket | null = null;
  private token: string;
  
  constructor(token: string) {
    this.token = token;
  }
  
  connect() {
    const wsUrl = `${import.meta.env.VITE_WS_BASE_URL}/ws/dashboard?token=${this.token}`;
    this.ws = new WebSocket(wsUrl);
    
    this.ws.onopen = () => {
      console.log('WebSocket connected');
      // Subscribe to scan updates
      this.send({
        type: 'subscribe',
        topic: 'scans',
        data: {}
      });
    };
    
    this.ws.onmessage = (event) => {
      const message = JSON.parse(event.data);
      this.handleMessage(message);
    };
  }
  
  send(message: any) {
    if (this.ws?.readyState === WebSocket.OPEN) {
      this.ws.send(JSON.stringify(message));
    }
  }
  
  private handleMessage(message: any) {
    switch (message.type) {
      case 'scan_started':
        // Handle scan started
        break;
      case 'scan_progress':
        // Update scan progress
        break;
      case 'scan_completed':
        // Handle scan completion
        break;
    }
  }
}
```

## Dashboard Components

### Recommended Page Structure

```
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ui/          # Reusable UI components
â”‚   â”œâ”€â”€ scans/       # Scan-related components
â”‚   â”œâ”€â”€ plugins/     # Plugin management
â”‚   â””â”€â”€ charts/      # Visualization components
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ Dashboard.tsx    # Main dashboard
â”‚   â”œâ”€â”€ Scans.tsx       # Scan management
â”‚   â”œâ”€â”€ Plugins.tsx     # Plugin management
â”‚   â”œâ”€â”€ Reports.tsx     # Reports & analytics
â”‚   â””â”€â”€ Settings.tsx    # System settings
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useAuth.ts      # Authentication hook
â”‚   â”œâ”€â”€ useWebSocket.ts # WebSocket hook
â”‚   â””â”€â”€ useScans.ts     # Scan management hook
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ api.ts          # API client
â”‚   â””â”€â”€ websocket.ts    # WebSocket client
â””â”€â”€ store/
    â””â”€â”€ index.ts        # State management
```

### Example Dashboard Component

```tsx
// Dashboard.tsx
import { useEffect, useState } from 'react';
import { useAuth } from '../hooks/useAuth';
import { useWebSocket } from '../hooks/useWebSocket';

export function Dashboard() {
  const { token } = useAuth();
  const [metrics, setMetrics] = useState(null);
  const { subscribe, messages } = useWebSocket(token);
  
  useEffect(() => {
    // Subscribe to dashboard updates
    subscribe('dashboard');
    
    // Fetch initial metrics
    fetchMetrics();
  }, []);
  
  const fetchMetrics = async () => {
    const response = await fetch('/api/v1/metrics', {
      headers: { Authorization: `Bearer ${token}` }
    });
    setMetrics(await response.json());
  };
  
  return (
    <div className="p-6">
      <h1 className="text-3xl font-bold">Scorpius Dashboard</h1>
      
      {/* Metrics Cards */}
      <div className="grid grid-cols-4 gap-6 mt-6">
        <MetricCard title="Active Scans" value={metrics?.scans?.active || 0} />
        <MetricCard title="Total Findings" value={metrics?.findings?.total || 0} />
        <MetricCard title="Plugins Available" value={metrics?.plugins?.available || 0} />
        <MetricCard title="System Health" value={metrics?.system?.status || 'Unknown'} />
      </div>
      
      {/* Recent Activity */}
      <div className="mt-8">
        <h2 className="text-xl font-semibold mb-4">Recent Activity</h2>
        <RecentScans />
      </div>
    </div>
  );
}
```

## Next Steps

1. **Set up your React/Vite project** using the examples above
2. **Implement authentication flow** with JWT tokens
3. **Build core dashboard components** for scans, plugins, and reports
4. **Add real-time updates** using WebSocket integration
5. **Style with Tailwind CSS** for a modern, responsive design

## API Reference

- **Full API Documentation**: `docs/api-documentation.md`
- **Live API Docs**: http://localhost:8080/docs
- **WebSocket Protocol**: See API documentation for message types

## Support

- **Backend Issues**: Check `logs/` directory for error logs
- **API Testing**: Use `python test_api.py` to verify endpoints
- **WebSocket Testing**: Use browser dev tools WebSocket inspector

The backend is fully functional and ready for frontend integration! ðŸš€
